

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Internal data formats &mdash; Code for Intelligent Triggering Online 1.5.2 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'1.5.2',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Code for Intelligent Triggering Online 1.5.2 documentation" href="index.html"/>
        <link rel="next" title="Jargon" href="jargon.html"/>
        <link rel="prev" title="Analyzing data" href="analyze_data.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> Code for Intelligent Triggering Online</a>
        <form class="wy-form" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Code for Intelligent Triggering Online</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readme.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#overview">Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-python3-3">Installing Python3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-system-dependencies">Installing system dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#preparing-python-environment">Preparing Python environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-cito">Installing Cito</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#optional-installing-own-mongodb-database">(Optional) Installing own MongoDB database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage.html#event-builder">Event Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#file-builder">File Builder</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="analyze_data.html">Analyzing data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Internal data formats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-to-event-builder-format">Input to Event Builder format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-from-event-builder-input-to-file-builder-format">Output from Event Builder, input to File Builder format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-from-file-builder-format">File from File Builder  format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jargon.html">Jargon</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#types-of-contributions">Types of Contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#pull-request-guidelines">Pull Request Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#tips">Tips</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authors.html#development-lead">Development Lead</a></li>
<li class="toctree-l2"><a class="reference internal" href="authors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a><ul>
<li class="toctree-l2"><a class="reference internal" href="history.html#id1">1.4 (2014-02-24)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id2">1.4 (2014-02-19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id3">1.1 (2014-02-12)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id4">1.0 (2014-02-10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id5">0.1 (2013-08-11)</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Code for Intelligent Triggering Online</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="index.html">Docs</a> &raquo;</li>
  <li><a href="">Internal data formats</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="internal-data-formats">
<h1>Internal data formats<a class="headerlink" href="#internal-data-formats" title="Permalink to this headline">¶</a></h1>
<p>All of the data formats specified refer to how data is stored within MongoDB.</p>
<div class="section" id="input-to-event-builder-format">
<h2>Input to Event Builder format<a class="headerlink" href="#input-to-event-builder-format" title="Permalink to this headline">¶</a></h2>
<p>This data is input to the event builder.</p>
<p>The data input format is a BSON document.  Per digitizer board, a document is created that must contain the keys:</p>
<ul class="simple">
<li>Module: identifies the digitizer board</li>
<li>Triggertime: This is a 64 bit number where the lower 32 bits are formed from the board time, and the upper 32 bits
from the system clock.  Each step is 10 ns.  There is enough range with 64 bits to not overflow the clock for about
10000 years, which from now was around when creation was in the Jewish calendar.</li>
<li>Data: The actual payload.  This is the raw Caen format (maybe compressed) and must be converted into a usable
format.</li>
<li>Zipped: Is the data compressed using <a class="reference external" href="https://code.google.com/p/snappy/">snappy</a>?</li>
</ul>
<p>Given that we are using a NoSQL database, variables may be added.  However, the schema only requires the four fields
above.</p>
<p>As of 22/October/2013, an example document is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&quot;525186149d7a330faeae9d68&quot;</span><span class="p">),</span>
    <span class="s2">&quot;insertsize&quot;</span><span class="o">:</span> <span class="nx">NumberInt</span><span class="p">(</span><span class="mi">46154</span><span class="p">),</span>
    <span class="s2">&quot;module&quot;</span><span class="o">:</span> <span class="nx">NumberInt</span><span class="p">(</span><span class="mi">876</span><span class="p">),</span>
    <span class="s2">&quot;triggertime&quot;</span><span class="o">:</span> <span class="nx">NumberLong</span><span class="p">(</span><span class="mi">1055247666930</span><span class="p">),</span>
    <span class="s2">&quot;zipped&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;datalength&quot;</span><span class="o">:</span> <span class="nx">NumberInt</span><span class="p">(</span><span class="mi">549</span><span class="p">),</span>
    <span class="s2">&quot;data&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;Mongo Binary Data&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="output-from-event-builder-input-to-file-builder-format">
<h2>Output from Event Builder, input to File Builder format<a class="headerlink" href="#output-from-event-builder-input-to-file-builder-format" title="Permalink to this headline">¶</a></h2>
<p>This is output of the event builder and input to the file builder.</p>
<ul class="simple">
<li>The <cite>_id</cite> field is a hex string used for internal bookkeeping within MongoDB.</li>
<li><cite>evt_num</cite> is an integer event number (if one has been assigned).</li>
<li><cite>range</cite> is two integers that correspond to the beginning and end of the trigger window.</li>
<li><cite>compressed_doc</cite> is binary data compressed with snappy and contains all the data that will go to file.  For more
information, see <a class="reference internal" href="analyze_data.html"><em>Analyzing data</em></a>.</li>
</ul>
<p>Said differently:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="nx">hex_string</span><span class="p">,</span>
    <span class="s2">&quot;evt_num&quot;</span><span class="o">:</span> <span class="kr">int</span><span class="p">,</span>
    <span class="s2">&quot;range&quot;</span><span class="o">:</span> <span class="p">[</span><span class="kr">int</span><span class="p">,</span> <span class="kr">int</span><span class="p">],</span>
    <span class="s2">&quot;compressed_doc&quot;</span><span class="o">:</span> <span class="nx">binary</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="file-from-file-builder-format">
<h2>File from File Builder  format<a class="headerlink" href="#file-from-file-builder-format" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="analyze_data.html"><em>Analyzing data</em></a></p>
</div>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="jargon.html" class="btn btn-neutral float-right" title="Jargon"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="analyze_data.html" class="btn btn-neutral" title="Analyzing data"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright 2013, Christopher Tunnell.
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>